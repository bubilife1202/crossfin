name = "crossfin-api"
main = "src/index.ts"
compatibility_date = "2025-02-13"

[[d1_databases]]
binding = "DB"
database_name = "crossfin-db"
database_id = "45a4ed54-bd2f-45dd-b1e4-d2be5f820f2c"
migrations_dir = "migrations"

[[routes]]
pattern = "crossfin.dev/api/*"
zone_name = "crossfin.dev"

[[routes]]
pattern = "www.crossfin.dev/api/*"
zone_name = "crossfin.dev"

[[routes]]
pattern = "crossfin.dev/.well-known/*"
zone_name = "crossfin.dev"

[[routes]]
pattern = "crossfin.dev/llms.txt"
zone_name = "crossfin.dev"

[vars]
FACILITATOR_URL = "https://facilitator.payai.network"
X402_NETWORK = "eip155:8453"
PAYMENT_RECEIVER_ADDRESS = "0xe4E79Ce6a1377C58f0Bb99D023908858A4DB5779"
# TELEGRAM_BOT_TOKEN and TELEGRAM_WEBHOOK_SECRET are stored as secrets
# Optional hardening: require token on /api/agents/register
# CROSSFIN_AGENT_SIGNUP_TOKEN should be set as a secret
# Set via: echo '<value>' | npx wrangler secret put TELEGRAM_BOT_TOKEN

[triggers]
crons = ["* * * * *"]  # every minute â€” uptime + kimchi snapshots
